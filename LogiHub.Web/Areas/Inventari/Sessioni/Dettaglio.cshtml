@model LogiHub.Web.Areas.Inventari.Sessioni.DettaglioSessioneViewModel

@{
    ViewData["Title"] = "Inventario - " + Model.NomeSessione;
}

<div>
    @await Html.PartialAsync("~/Features/SearchCard/_SearchCardSimple.cshtml", Model.SearchCard)
</div>

<div class="card shadow-sm">
    <div class="card-body p-1">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4" style="width: 1%; white-space: nowrap;">Ubicazione</th>
                        <th class="text-center" style="width: 1%; white-space: nowrap;">Stato</th>
                        <th>Dettagli</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        var ubicazioniDaFare = Model.UbicazioniFiltrate.Where(u => !u.Completata && !u.InLavorazione);
                        var ubicazioniInLavorazione = Model.UbicazioniFiltrate.Where(u => u.InLavorazione);
                        var ubicazioniCompletate = Model.UbicazioniFiltrate.Where(u => u.Completata);
                    }

                    @if (ubicazioniDaFare.Any())
                    {
                        <tr class="table-secondary">
                            <td colspan="3" class="ps-4 fw-semibold text-muted text-center">Da Fare</td>
                        </tr>
                        @foreach (var ubicazione in ubicazioniDaFare)
                        {
                            <tr>
                                <td class="ps-4">@ubicazione.Posizione</td>
                                <td class="text-center">
                                    <span class="badge rounded-pill bg-light text-dark border">Da Fare</span>
                                </td>
                                <td class="pe-4"></td>
                            </tr>
                        }
                    }

                    @if (ubicazioniInLavorazione.Any())
                    {
                        <tr class="table-secondary">
                            <td colspan="3" class="ps-4 fw-semibold text-muted">In Lavorazione</td>
                        </tr>
                        @foreach (var ubicazione in ubicazioniInLavorazione)
                        {
                            <tr class="table-warning">
                                <td class="ps-4">@ubicazione.Posizione</td>
                                <td class="text-center">
                                    <span class="badge bg-warning text-dark">In Lavorazione</span>
                                </td>
                                <td>
                                    <small class="text-muted">In Lavorazione da: @ubicazione.OperatoreCorrente</small>
                                </td>
                            </tr>
                        }
                    }

                    @if (ubicazioniCompletate.Any())
                    {
                        <tr class="table-secondary">
                            <td colspan="3" class="ps-4 fw-semibold text-muted">Completati</td>
                        </tr>
                        @foreach (var ubicazione in ubicazioniCompletate)
                        {
                            <tr>
                                <td class="ps-4">@ubicazione.Posizione</td>
                                <td class="text-center">
                                    <span class="badge bg-success">Completato</span>
                                </td>
                                <td>
                                    <small class="text-muted">Completato da: @ubicazione.OperatoreCorrente</small>
                                </td>
                            </tr>
                        }
                    }

                    @if (!Model.UbicazioniFiltrate.Any())
                    {
                        <tr>
                            <td colspan="3" class="text-center py-4 text-muted">
                                <i class="fa-solid fa-search me-2"></i>
                                Nessuna ubicazione trovata.
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>